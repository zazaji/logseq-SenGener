var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},n={},r=e.parcelRequire5e12;null==r&&((r=function(e){if(e in t)return t[e].exports;if(e in n){var r=n[e];delete n[e];var o={id:e,exports:{}};return t[e]=o,r.call(o.exports,o,o.exports),o.exports}var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){n[e]=t},e.parcelRequire5e12=r),r.register("hYbfg",(function(t,n){var r,o;r=self,o=()=>(()=>{var r={227:(e,t,n)=>{var r=n(155);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(447)(t);const{formatters:o}=e.exports;o.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},447:(e,t,n)=>{e.exports=function(e){function t(e){let n,o,i,a=null;function s(...e){if(!s.enabled)return;const r=s,o=Number(new Date),i=o-(n||o);r.diff=i,r.prev=n,r.curr=o,n=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return"%";a++;const i=t.formatters[o];if("function"==typeof i){const t=e[a];n=i.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e),(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},856:function(e){e.exports=function(){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,n){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,n)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function r(e,o,i){return(r=n()?Reflect.construct:function(e,n,r){var o=[null];o.push.apply(o,n);var i=new(Function.bind.apply(e,o));return r&&t(i,r.prototype),i}).apply(null,arguments)}function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=Object.hasOwnProperty,s=Object.setPrototypeOf,c=Object.isFrozen,l=Object.getPrototypeOf,u=Object.getOwnPropertyDescriptor,p=Object.freeze,d=Object.seal,h=Object.create,f="undefined"!=typeof Reflect&&Reflect,m=f.apply,g=f.construct;m||(m=function(e,t,n){return e.apply(t,n)}),p||(p=function(e){return e}),d||(d=function(e){return e}),g||(g=function(e,t){return r(e,o(t))});var y,b=T(Array.prototype.forEach),v=T(Array.prototype.pop),_=T(Array.prototype.push),w=T(String.prototype.toLowerCase),x=T(String.prototype.match),k=T(String.prototype.replace),C=T(String.prototype.indexOf),S=T(String.prototype.trim),E=T(RegExp.prototype.test),O=(y=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return g(y,t)});function T(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return m(e,t,r)}}function A(e,t){s&&s(e,null);for(var n=t.length;n--;){var r=t[n];if("string"==typeof r){var o=w(r);o!==r&&(c(t)||(t[n]=o),r=o)}e[r]=!0}return e}function j(e){var t,n=h(null);for(t in e)m(a,e,[t])&&(n[t]=e[t]);return n}function I(e,t){for(;null!==e;){var n=u(e,t);if(n){if(n.get)return T(n.get);if("function"==typeof n.value)return T(n.value)}e=l(e)}return function(e){return console.warn("fallback value for",e),null}}var F=p(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),N=p(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),L=p(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),M=p(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),R=p(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),U=p(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),D=p(["#text"]),P=p(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),z=p(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),q=p(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),$=p(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),H=d(/\{\{[\w\W]*|[\w\W]*\}\}/gm),B=d(/<%[\w\W]*|[\w\W]*%>/gm),G=d(/^data-[\-\w.\u00B7-\uFFFF]/),W=d(/^aria-[\-\w]+$/),J=d(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Z=d(/^(?:\w+script|data):/i),Y=d(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),K=d(/^html$/i),V=function(){return"undefined"==typeof window?null:window},X=function(t,n){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var r=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(r=n.currentScript.getAttribute(o));var i="dompurify"+(r?"#"+r:"");try{return t.createPolicy(i,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};return function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V(),r=function(e){return t(e)};if(r.version="2.3.8",r.removed=[],!n||!n.document||9!==n.document.nodeType)return r.isSupported=!1,r;var i=n.document,a=n.document,s=n.DocumentFragment,c=n.HTMLTemplateElement,l=n.Node,u=n.Element,d=n.NodeFilter,h=n.NamedNodeMap,f=void 0===h?n.NamedNodeMap||n.MozNamedAttrMap:h,m=n.HTMLFormElement,g=n.DOMParser,y=n.trustedTypes,T=u.prototype,Q=I(T,"cloneNode"),ee=I(T,"nextSibling"),te=I(T,"childNodes"),ne=I(T,"parentNode");if("function"==typeof c){var re=a.createElement("template");re.content&&re.content.ownerDocument&&(a=re.content.ownerDocument)}var oe=X(y,i),ie=oe?oe.createHTML(""):"",ae=a,se=ae.implementation,ce=ae.createNodeIterator,le=ae.createDocumentFragment,ue=ae.getElementsByTagName,pe=i.importNode,de={};try{de=j(a).documentMode?a.documentMode:{}}catch(e){}var he={};r.isSupported="function"==typeof ne&&se&&void 0!==se.createHTMLDocument&&9!==de;var fe,me,ge=H,ye=B,be=G,ve=W,_e=Z,we=Y,xe=J,ke=null,Ce=A({},[].concat(o(F),o(N),o(L),o(R),o(D))),Se=null,Ee=A({},[].concat(o(P),o(z),o(q),o($))),Oe=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Te=null,Ae=null,je=!0,Ie=!0,Fe=!1,Ne=!1,Le=!1,Me=!1,Re=!1,Ue=!1,De=!1,Pe=!1,ze=!0,qe=!0,$e=!1,He={},Be=null,Ge=A({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),We=null,Je=A({},["audio","video","img","source","image","track"]),Ze=null,Ye=A({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ke="http://www.w3.org/1998/Math/MathML",Ve="http://www.w3.org/2000/svg",Xe="http://www.w3.org/1999/xhtml",Qe=Xe,et=!1,tt=["application/xhtml+xml","text/html"],nt="text/html",rt=null,ot=a.createElement("form"),it=function(e){return e instanceof RegExp||e instanceof Function},at=function(t){rt&&rt===t||(t&&"object"===e(t)||(t={}),t=j(t),ke="ALLOWED_TAGS"in t?A({},t.ALLOWED_TAGS):Ce,Se="ALLOWED_ATTR"in t?A({},t.ALLOWED_ATTR):Ee,Ze="ADD_URI_SAFE_ATTR"in t?A(j(Ye),t.ADD_URI_SAFE_ATTR):Ye,We="ADD_DATA_URI_TAGS"in t?A(j(Je),t.ADD_DATA_URI_TAGS):Je,Be="FORBID_CONTENTS"in t?A({},t.FORBID_CONTENTS):Ge,Te="FORBID_TAGS"in t?A({},t.FORBID_TAGS):{},Ae="FORBID_ATTR"in t?A({},t.FORBID_ATTR):{},He="USE_PROFILES"in t&&t.USE_PROFILES,je=!1!==t.ALLOW_ARIA_ATTR,Ie=!1!==t.ALLOW_DATA_ATTR,Fe=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Ne=t.SAFE_FOR_TEMPLATES||!1,Le=t.WHOLE_DOCUMENT||!1,Ue=t.RETURN_DOM||!1,De=t.RETURN_DOM_FRAGMENT||!1,Pe=t.RETURN_TRUSTED_TYPE||!1,Re=t.FORCE_BODY||!1,ze=!1!==t.SANITIZE_DOM,qe=!1!==t.KEEP_CONTENT,$e=t.IN_PLACE||!1,xe=t.ALLOWED_URI_REGEXP||xe,Qe=t.NAMESPACE||Xe,t.CUSTOM_ELEMENT_HANDLING&&it(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Oe.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&it(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Oe.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Oe.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),fe=fe=-1===tt.indexOf(t.PARSER_MEDIA_TYPE)?nt:t.PARSER_MEDIA_TYPE,me="application/xhtml+xml"===fe?function(e){return e}:w,Ne&&(Ie=!1),De&&(Ue=!0),He&&(ke=A({},o(D)),Se=[],!0===He.html&&(A(ke,F),A(Se,P)),!0===He.svg&&(A(ke,N),A(Se,z),A(Se,$)),!0===He.svgFilters&&(A(ke,L),A(Se,z),A(Se,$)),!0===He.mathMl&&(A(ke,R),A(Se,q),A(Se,$))),t.ADD_TAGS&&(ke===Ce&&(ke=j(ke)),A(ke,t.ADD_TAGS)),t.ADD_ATTR&&(Se===Ee&&(Se=j(Se)),A(Se,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&A(Ze,t.ADD_URI_SAFE_ATTR),t.FORBID_CONTENTS&&(Be===Ge&&(Be=j(Be)),A(Be,t.FORBID_CONTENTS)),qe&&(ke["#text"]=!0),Le&&A(ke,["html","head","body"]),ke.table&&(A(ke,["tbody"]),delete Te.tbody),p&&p(t),rt=t)},st=A({},["mi","mo","mn","ms","mtext"]),ct=A({},["foreignobject","desc","title","annotation-xml"]),lt=A({},["title","style","font","a","script"]),ut=A({},N);A(ut,L),A(ut,M);var pt=A({},R);A(pt,U);var dt=function(e){var t=ne(e);t&&t.tagName||(t={namespaceURI:Xe,tagName:"template"});var n=w(e.tagName),r=w(t.tagName);return e.namespaceURI===Ve?t.namespaceURI===Xe?"svg"===n:t.namespaceURI===Ke?"svg"===n&&("annotation-xml"===r||st[r]):Boolean(ut[n]):e.namespaceURI===Ke?t.namespaceURI===Xe?"math"===n:t.namespaceURI===Ve?"math"===n&&ct[r]:Boolean(pt[n]):e.namespaceURI===Xe&&!(t.namespaceURI===Ve&&!ct[r])&&!(t.namespaceURI===Ke&&!st[r])&&!pt[n]&&(lt[n]||!ut[n])},ht=function(e){_(r.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ie}catch(t){e.remove()}}},ft=function(e,t){try{_(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){_(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Se[e])if(Ue||De)try{ht(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},mt=function(e){var t,n;if(Re)e="<remove></remove>"+e;else{var r=x(e,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===fe&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var o=oe?oe.createHTML(e):e;if(Qe===Xe)try{t=(new g).parseFromString(o,fe)}catch(e){}if(!t||!t.documentElement){t=se.createDocument(Qe,"template",null);try{t.documentElement.innerHTML=et?"":o}catch(e){}}var i=t.body||t.documentElement;return e&&n&&i.insertBefore(a.createTextNode(n),i.childNodes[0]||null),Qe===Xe?ue.call(t,Le?"html":"body")[0]:Le?t.documentElement:i},gt=function(e){return ce.call(e.ownerDocument||e,e,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT,null,!1)},yt=function(e){return e instanceof m&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof f)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)},bt=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},vt=function(e,t,n){he[e]&&b(he[e],(function(e){e.call(r,t,n,rt)}))},_t=function(e){var t;if(vt("beforeSanitizeElements",e,null),yt(e))return ht(e),!0;if(E(/[\u0080-\uFFFF]/,e.nodeName))return ht(e),!0;var n=me(e.nodeName);if(vt("uponSanitizeElement",e,{tagName:n,allowedTags:ke}),e.hasChildNodes()&&!bt(e.firstElementChild)&&(!bt(e.content)||!bt(e.content.firstElementChild))&&E(/<[/\w]/g,e.innerHTML)&&E(/<[/\w]/g,e.textContent))return ht(e),!0;if("select"===n&&E(/<template/i,e.innerHTML))return ht(e),!0;if(!ke[n]||Te[n]){if(!Te[n]&&xt(n)){if(Oe.tagNameCheck instanceof RegExp&&E(Oe.tagNameCheck,n))return!1;if(Oe.tagNameCheck instanceof Function&&Oe.tagNameCheck(n))return!1}if(qe&&!Be[n]){var o=ne(e)||e.parentNode,i=te(e)||e.childNodes;if(i&&o)for(var a=i.length-1;a>=0;--a)o.insertBefore(Q(i[a],!0),ee(e))}return ht(e),!0}return e instanceof u&&!dt(e)?(ht(e),!0):"noscript"!==n&&"noembed"!==n||!E(/<\/no(script|embed)/i,e.innerHTML)?(Ne&&3===e.nodeType&&(t=e.textContent,t=k(t,ge," "),t=k(t,ye," "),e.textContent!==t&&(_(r.removed,{element:e.cloneNode()}),e.textContent=t)),vt("afterSanitizeElements",e,null),!1):(ht(e),!0)},wt=function(e,t,n){if(ze&&("id"===t||"name"===t)&&(n in a||n in ot))return!1;if(Ie&&!Ae[t]&&E(be,t));else if(je&&E(ve,t));else if(!Se[t]||Ae[t]){if(!(xt(e)&&(Oe.tagNameCheck instanceof RegExp&&E(Oe.tagNameCheck,e)||Oe.tagNameCheck instanceof Function&&Oe.tagNameCheck(e))&&(Oe.attributeNameCheck instanceof RegExp&&E(Oe.attributeNameCheck,t)||Oe.attributeNameCheck instanceof Function&&Oe.attributeNameCheck(t))||"is"===t&&Oe.allowCustomizedBuiltInElements&&(Oe.tagNameCheck instanceof RegExp&&E(Oe.tagNameCheck,n)||Oe.tagNameCheck instanceof Function&&Oe.tagNameCheck(n))))return!1}else if(Ze[t]);else if(E(xe,k(n,we,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==C(n,"data:")||!We[e])if(Fe&&!E(_e,k(n,we,"")));else if(n)return!1;return!0},xt=function(e){return e.indexOf("-")>0},kt=function(e){var t,n,o,i;vt("beforeSanitizeAttributes",e,null);var a=e.attributes;if(a){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Se};for(i=a.length;i--;){var c=t=a[i],l=c.name,u=c.namespaceURI;if(n="value"===l?t.value:S(t.value),o=me(l),s.attrName=o,s.attrValue=n,s.keepAttr=!0,s.forceKeepAttr=void 0,vt("uponSanitizeAttribute",e,s),n=s.attrValue,!s.forceKeepAttr&&(ft(l,e),s.keepAttr))if(E(/\/>/i,n))ft(l,e);else{Ne&&(n=k(n,ge," "),n=k(n,ye," "));var p=me(e.nodeName);if(wt(p,o,n))try{u?e.setAttributeNS(u,l,n):e.setAttribute(l,n),v(r.removed)}catch(e){}}}vt("afterSanitizeAttributes",e,null)}},Ct=function e(t){var n,r=gt(t);for(vt("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)vt("uponSanitizeShadowNode",n,null),_t(n)||(n.content instanceof s&&e(n.content),kt(n));vt("afterSanitizeShadowDOM",t,null)};return r.sanitize=function(t,o){var a,c,u,p,d;if((et=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!bt(t)){if("function"!=typeof t.toString)throw O("toString is not a function");if("string"!=typeof(t=t.toString()))throw O("dirty is not a string, aborting")}if(!r.isSupported){if("object"===e(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof t)return n.toStaticHTML(t);if(bt(t))return n.toStaticHTML(t.outerHTML)}return t}if(Me||at(o),r.removed=[],"string"==typeof t&&($e=!1),$e){if(t.nodeName){var h=me(t.nodeName);if(!ke[h]||Te[h])throw O("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof l)1===(c=(a=mt("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===c.nodeName||"HTML"===c.nodeName?a=c:a.appendChild(c);else{if(!Ue&&!Ne&&!Le&&-1===t.indexOf("<"))return oe&&Pe?oe.createHTML(t):t;if(!(a=mt(t)))return Ue?null:Pe?ie:""}a&&Re&&ht(a.firstChild);for(var f=gt($e?t:a);u=f.nextNode();)3===u.nodeType&&u===p||_t(u)||(u.content instanceof s&&Ct(u.content),kt(u),p=u);if(p=null,$e)return t;if(Ue){if(De)for(d=le.call(a.ownerDocument);a.firstChild;)d.appendChild(a.firstChild);else d=a;return Se.shadowroot&&(d=pe.call(i,d,!0)),d}var m=Le?a.outerHTML:a.innerHTML;return Le&&ke["!doctype"]&&a.ownerDocument&&a.ownerDocument.doctype&&a.ownerDocument.doctype.name&&E(K,a.ownerDocument.doctype.name)&&(m="<!DOCTYPE "+a.ownerDocument.doctype.name+">\n"+m),Ne&&(m=k(m,ge," "),m=k(m,ye," ")),oe&&Pe?oe.createHTML(m):m},r.setConfig=function(e){at(e),Me=!0},r.clearConfig=function(){rt=null,Me=!1},r.isValidAttribute=function(e,t,n){rt||at({});var r=me(e),o=me(t);return wt(r,o,n)},r.addHook=function(e,t){"function"==typeof t&&(he[e]=he[e]||[],_(he[e],t))},r.removeHook=function(e){if(he[e])return v(he[e])},r.removeHooks=function(e){he[e]&&(he[e]=[])},r.removeAllHooks=function(){he={}},r}()}()},729:e=>{var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new o(r,i||e,a),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,a=new Array(i);o<i;o++)a[o]=r[o].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,o,i,a){var s=n?n+e:e;if(!this._events[s])return!1;var c,l,u=this._events[s],p=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),p){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,r),!0;case 4:return u.fn.call(u.context,t,r,o),!0;case 5:return u.fn.call(u.context,t,r,o,i),!0;case 6:return u.fn.call(u.context,t,r,o,i,a),!0}for(l=1,c=new Array(p-1);l<p;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var d,h=u.length;for(l=0;l<h;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),p){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,r);break;case 4:u[l].fn.call(u[l].context,t,r,o);break;default:if(!c)for(d=1,c=new Array(p-1);d<p;d++)c[d-1]=arguments[d];u[l].fn.apply(u[l].context,c)}}return!0},s.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return a(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||o&&!s.once||r&&s.context!==r||a(this,i);else{for(var c=0,l=[],u=s.length;c<u;c++)(s[c].fn!==t||o&&!s[c].once||r&&s[c].context!==r)&&l.push(s[c]);l.length?this._events[i]=1===l.length?l[0]:l:a(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},824:e=>{var t=1e3,n=6e4,r=60*n,o=24*r;function i(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,a){a=a||{};var s,c,l,u,p=typeof e;if("string"===p&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(i){var a=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"weeks":case"week":case"w":return 6048e5*a;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*r;case"minutes":case"minute":case"mins":case"min":case"m":return a*n;case"seconds":case"second":case"secs":case"sec":case"s":return a*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(e);if("number"===p&&isFinite(e))return a.long?(s=e,(c=Math.abs(s))>=o?i(s,c,o,"day"):c>=r?i(s,c,r,"hour"):c>=n?i(s,c,n,"minute"):c>=t?i(s,c,t,"second"):s+" ms"):(l=e,(u=Math.abs(l))>=o?Math.round(l/o)+"d":u>=r?Math.round(l/r)+"h":u>=n?Math.round(l/n)+"m":u>=t?Math.round(l/t)+"s":l+"ms");throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},520:(e,t,n)=>{var r=n(155),o="win32"===r.platform,i=n(539);function a(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];o&&"."!==o&&(".."===o?n.length&&".."!==n[n.length-1]?n.pop():t&&n.push(".."):n.push(o))}return n}function s(e){for(var t=e.length-1,n=0;n<=t&&!e[n];n++);for(var r=t;r>=0&&!e[r];r--);return 0===n&&r===t?e:n>r?[]:e.slice(n,r+1)}var c=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,l=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,u={};function p(e){var t=c.exec(e),n=(t[1]||"")+(t[2]||""),r=t[3]||"",o=l.exec(r);return[n,o[1],o[2],o[3]]}function d(e){var t=c.exec(e),n=t[1]||"",r=!!n&&":"!==n[1];return{device:n,isUnc:r,isAbsolute:r||!!t[2],tail:t[3]}}function h(e){return"\\\\"+e.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}u.resolve=function(){for(var e="",t="",n=!1,o=arguments.length-1;o>=-1;o--){var s;if(o>=0?s=arguments[o]:e?(s=r.env["="+e])&&s.substr(0,3).toLowerCase()===e.toLowerCase()+"\\"||(s=e+"\\"):s=r.cwd(),!i.isString(s))throw new TypeError("Arguments to path.resolve must be strings");if(s){var c=d(s),l=c.device,u=c.isUnc,p=c.isAbsolute,f=c.tail;if((!l||!e||l.toLowerCase()===e.toLowerCase())&&(e||(e=l),n||(t=f+"\\"+t,n=p),e&&n))break}}return u&&(e=h(e)),e+(n?"\\":"")+(t=a(t.split(/[\\\/]+/),!n).join("\\"))||"."},u.normalize=function(e){var t=d(e),n=t.device,r=t.isUnc,o=t.isAbsolute,i=t.tail,s=/[\\\/]$/.test(i);return(i=a(i.split(/[\\\/]+/),!o).join("\\"))||o||(i="."),i&&s&&(i+="\\"),r&&(n=h(n)),n+(o?"\\":"")+i},u.isAbsolute=function(e){return d(e).isAbsolute},u.join=function(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(!i.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&e.push(n)}var r=e.join("\\");return/^[\\\/]{2}[^\\\/]/.test(e[0])||(r=r.replace(/^[\\\/]{2,}/,"\\")),u.normalize(r)},u.relative=function(e,t){e=u.resolve(e),t=u.resolve(t);for(var n=e.toLowerCase(),r=t.toLowerCase(),o=s(t.split("\\")),i=s(n.split("\\")),a=s(r.split("\\")),c=Math.min(i.length,a.length),l=c,p=0;p<c;p++)if(i[p]!==a[p]){l=p;break}if(0==l)return t;var d=[];for(p=l;p<i.length;p++)d.push("..");return(d=d.concat(o.slice(l))).join("\\")},u._makeLong=function(e){if(!i.isString(e))return e;if(!e)return"";var t=u.resolve(e);return/^[a-zA-Z]\:\\/.test(t)?"\\\\?\\"+t:/^\\\\[^?.]/.test(t)?"\\\\?\\UNC\\"+t.substring(2):e},u.dirname=function(e){var t=p(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},u.basename=function(e,t){var n=p(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},u.extname=function(e){return p(e)[3]},u.format=function(e){if(!i.isObject(e))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var t=e.root||"";if(!i.isString(t))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);var n=e.dir,r=e.base||"";return n?n[n.length-1]===u.sep?n+r:n+u.sep+r:r},u.parse=function(e){if(!i.isString(e))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t=p(e);if(!t||4!==t.length)throw new TypeError("Invalid path '"+e+"'");return{root:t[0],dir:t[0]+t[1].slice(0,-1),base:t[2],ext:t[3],name:t[2].slice(0,t[2].length-t[3].length)}},u.sep="\\",u.delimiter=";";var f=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,m={};function g(e){return f.exec(e).slice(1)}m.resolve=function(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var o=n>=0?arguments[n]:r.cwd();if(!i.isString(o))throw new TypeError("Arguments to path.resolve must be strings");o&&(e=o+"/"+e,t="/"===o[0])}return(t?"/":"")+(e=a(e.split("/"),!t).join("/"))||"."},m.normalize=function(e){var t=m.isAbsolute(e),n=e&&"/"===e[e.length-1];return(e=a(e.split("/"),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e},m.isAbsolute=function(e){return"/"===e.charAt(0)},m.join=function(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];if(!i.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&(e+=e?"/"+n:n)}return m.normalize(e)},m.relative=function(e,t){e=m.resolve(e).substr(1),t=m.resolve(t).substr(1);for(var n=s(e.split("/")),r=s(t.split("/")),o=Math.min(n.length,r.length),i=o,a=0;a<o;a++)if(n[a]!==r[a]){i=a;break}var c=[];for(a=i;a<n.length;a++)c.push("..");return(c=c.concat(r.slice(i))).join("/")},m._makeLong=function(e){return e},m.dirname=function(e){var t=g(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},m.basename=function(e,t){var n=g(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},m.extname=function(e){return g(e)[3]},m.format=function(e){if(!i.isObject(e))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var t=e.root||"";if(!i.isString(t))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);return(e.dir?e.dir+m.sep:"")+(e.base||"")},m.parse=function(e){if(!i.isString(e))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t=g(e);if(!t||4!==t.length)throw new TypeError("Invalid path '"+e+"'");return t[1]=t[1]||"",t[2]=t[2]||"",t[3]=t[3]||"",{root:t[0],dir:t[0]+t[1].slice(0,-1),base:t[2],ext:t[3],name:t[2].slice(0,t[2].length-t[3].length)}},m.sep="/",m.delimiter=":",e.exports=o?u:m,e.exports.posix=m,e.exports.win32=u},155:e=>{var t,n,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var s,c=[],l=!1,u=-1;function p(){l&&s&&(l=!1,s.length?c=s.concat(c):u=-1,c.length&&d())}function d(){if(!l){var e=a(p);l=!0;for(var t=c.length;t;){for(s=c,c=[];++u<t;)s&&s[u].run();u=-1,t=c.length}s=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function f(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||l||a(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},496:e=>{"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},384:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},539:(e,t,n)=>{var r=n(155),o=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,i=r.length,a=String(e).replace(o,(function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),c=r[n];n<i;c=r[++n])m(c)||!_(c)?a+=" "+c:a+=" "+s(c);return a},t.deprecate=function(e,o){if(b(n.g.process))return function(){return t.deprecate(e,o).apply(this,arguments)};if(!0===r.noDeprecation)return e;var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),i=!0}return e.apply(this,arguments)}};var i,a={};function s(e,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),f(n)?r.showHidden=n:n&&t._extend(r,n),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),u(r,e,r.depth)}function c(e,t){var n=s.styles[t];return n?"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m":e}function l(e,t){return e}function u(e,n,r){if(e.customInspect&&n&&k(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return y(o)||(o=u(e,o,r)),o}var i=function(e,t){if(b(t))return e.stylize("undefined","undefined");if(y(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return g(t)?e.stylize(""+t,"number"):f(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}(e,n);if(i)return i;var a,s=Object.keys(n),c=(a={},s.forEach((function(e,t){a[e]=!0})),a);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),x(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return p(n);if(0===s.length){if(k(n)){var l=n.name?": "+n.name:"";return e.stylize("[Function"+l+"]","special")}if(v(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return e.stylize(Date.prototype.toString.call(n),"date");if(x(n))return p(n)}var _,C,S,E,O="",A=!1,j=["{","}"];return h(n)&&(A=!0,j=["[","]"]),k(n)&&(O=" [Function"+(n.name?": "+n.name:"")+"]"),v(n)&&(O=" "+RegExp.prototype.toString.call(n)),w(n)&&(O=" "+Date.prototype.toUTCString.call(n)),x(n)&&(O=" "+p(n)),0!==s.length||A&&0!=n.length?r<0?v(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),_=A?function(e,t,n,r,o){for(var i=[],a=0,s=t.length;a<s;++a)T(t,String(a))?i.push(d(e,t,n,r,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(d(e,t,n,r,o,!0))})),i}(e,n,r,c,s):s.map((function(t){return d(e,n,r,c,t,A)})),e.seen.pop(),S=O,E=j,(C=_).reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?E[0]+(""===S?"":S+"\n ")+" "+C.join(",\n  ")+" "+E[1]:E[0]+S+" "+C.join(", ")+" "+E[1]):j[0]+O+j[1]}function p(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,o,i){var a,s,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),T(r,o)||(a="["+o+"]"),s||(e.seen.indexOf(c.value)<0?(s=m(n)?u(e,c.value,null):u(e,c.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),b(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function h(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function m(e){return null===e}function g(e){return"number"==typeof e}function y(e){return"string"==typeof e}function b(e){return void 0===e}function v(e){return _(e)&&"[object RegExp]"===C(e)}function _(e){return"object"==typeof e&&null!==e}function w(e){return _(e)&&"[object Date]"===C(e)}function x(e){return _(e)&&("[object Error]"===C(e)||e instanceof Error)}function k(e){return"function"==typeof e}function C(e){return Object.prototype.toString.call(e)}function S(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(b(i)&&(i=r.env.NODE_DEBUG||""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(i)){var n=r.pid;a[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else a[e]=function(){};return a[e]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=h,t.isBoolean=f,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=y,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=b,t.isRegExp=v,t.isObject=_,t.isDate=w,t.isError=x,t.isFunction=k,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(384);var E=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(){var e=new Date,t=[S(e.getHours()),S(e.getMinutes()),S(e.getSeconds())].join(":");return[e.getDate(),E[e.getMonth()],t].join(" ")}function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",O(),t.format.apply(t,arguments))},t.inherits=n(496),t._extend=function(e,t){if(!t||!_(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return r[e].call(n.exports,n,n.exports,i),n.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};return(()=>{i.r(a),i.d(a,{LSPluginUser:()=>Gt,setupPluginUserInstance:()=>Wt});var r=i(520);i(856);const o=function(e,t){return e===t||e!=e&&t!=t},s=function(e,t){for(var n=e.length;n--;)if(o(e[n][0],t))return n;return-1};var c=Array.prototype.splice;function l(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}l.prototype.clear=function(){this.__data__=[],this.size=0},l.prototype.delete=function(e){var t=this.__data__,n=s(t,e);return!(n<0||(n==t.length-1?t.pop():c.call(t,n,1),--this.size,0))},l.prototype.get=function(e){var t=this.__data__,n=s(t,e);return n<0?void 0:t[n][1]},l.prototype.has=function(e){return s(this.__data__,e)>-1},l.prototype.set=function(e,t){var n=this.__data__,r=s(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};const u=l,p="object"==typeof e&&e&&e.Object===Object&&e;var d="object"==typeof self&&self&&self.Object===Object&&self;const h=p||d||Function("return this")(),f=h.Symbol;var m=Object.prototype,g=m.hasOwnProperty,y=m.toString,b=f?f.toStringTag:void 0,v=Object.prototype.toString,_=f?f.toStringTag:void 0;const w=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":_&&_ in Object(e)?function(e){var t=g.call(e,b),n=e[b];try{e[b]=void 0;var r=!0}catch(e){}var o=y.call(e);return r&&(t?e[b]=n:delete e[b]),o}(e):(t=e,v.call(t));var t},x=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},k=function(e){if(!x(e))return!1;var t=w(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},C=h["__core-js_shared__"];var S,E=(S=/[^.]+$/.exec(C&&C.keys&&C.keys.IE_PROTO||""))?"Symbol(src)_1."+S:"",O=Function.prototype.toString,T=/^\[object .+?Constructor\]$/,A=Function.prototype,j=Object.prototype,I=A.toString,F=j.hasOwnProperty,N=RegExp("^"+I.call(F).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const L=function(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){var t;return!(!x(e)||(t=e,E&&E in t))&&(k(e)?N:T).test(function(e){if(null!=e){try{return O.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e))}(n)?n:void 0},M=L(h,"Map"),R=L(Object,"create");var U=Object.prototype.hasOwnProperty,D=Object.prototype.hasOwnProperty;function P(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}P.prototype.clear=function(){this.__data__=R?R(null):{},this.size=0},P.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},P.prototype.get=function(e){var t=this.__data__;if(R){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return U.call(t,e)?t[e]:void 0},P.prototype.has=function(e){var t=this.__data__;return R?void 0!==t[e]:D.call(t,e)},P.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=R&&void 0===t?"__lodash_hash_undefined__":t,this};const z=P,q=function(e,t){var n,r,o=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map};function $(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}$.prototype.clear=function(){this.size=0,this.__data__={hash:new z,map:new(M||u),string:new z}},$.prototype.delete=function(e){var t=q(this,e).delete(e);return this.size-=t?1:0,t},$.prototype.get=function(e){return q(this,e).get(e)},$.prototype.has=function(e){return q(this,e).has(e)},$.prototype.set=function(e,t){var n=q(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};const H=$;function B(e){var t=this.__data__=new u(e);this.size=t.size}B.prototype.clear=function(){this.__data__=new u,this.size=0},B.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},B.prototype.get=function(e){return this.__data__.get(e)},B.prototype.has=function(e){return this.__data__.has(e)},B.prototype.set=function(e,t){var n=this.__data__;if(n instanceof u){var r=n.__data__;if(!M||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new H(r)}return n.set(e,t),this.size=n.size,this};const G=B,W=function(){try{var e=L(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),J=function(e,t,n){"__proto__"==t&&W?W(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},Z=function(e,t,n){(void 0!==n&&!o(e[t],n)||void 0===n&&!(t in e))&&J(e,t,n)};var Y="object"==typeof n&&n&&!n.nodeType&&n,K=Y&&t&&!t.nodeType&&t,V=K&&K.exports===Y?h.Buffer:void 0;V&&V.allocUnsafe;const X=h.Uint8Array;var Q=Object.create;const ee=function(){function e(){}return function(t){if(!x(t))return{};if(Q)return Q(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),te=(ne=Object.getPrototypeOf,re=Object,function(e){return ne(re(e))});var ne,re,oe=Object.prototype;const ie=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||oe)},ae=function(e){return null!=e&&"object"==typeof e},se=function(e){return ae(e)&&"[object Arguments]"==w(e)};var ce=Object.prototype,le=ce.hasOwnProperty,ue=ce.propertyIsEnumerable;const pe=se(function(){return arguments}())?se:function(e){return ae(e)&&le.call(e,"callee")&&!ue.call(e,"callee")},de=Array.isArray,he=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},fe=function(e){return null!=e&&he(e.length)&&!k(e)};var me="object"==typeof n&&n&&!n.nodeType&&n,ge=me&&t&&!t.nodeType&&t,ye=ge&&ge.exports===me?h.Buffer:void 0;const be=(ye?ye.isBuffer:void 0)||function(){return!1};var ve=Function.prototype,_e=Object.prototype,we=ve.toString,xe=_e.hasOwnProperty,ke=we.call(Object),Ce={};Ce["[object Float32Array]"]=Ce["[object Float64Array]"]=Ce["[object Int8Array]"]=Ce["[object Int16Array]"]=Ce["[object Int32Array]"]=Ce["[object Uint8Array]"]=Ce["[object Uint8ClampedArray]"]=Ce["[object Uint16Array]"]=Ce["[object Uint32Array]"]=!0,Ce["[object Arguments]"]=Ce["[object Array]"]=Ce["[object ArrayBuffer]"]=Ce["[object Boolean]"]=Ce["[object DataView]"]=Ce["[object Date]"]=Ce["[object Error]"]=Ce["[object Function]"]=Ce["[object Map]"]=Ce["[object Number]"]=Ce["[object Object]"]=Ce["[object RegExp]"]=Ce["[object Set]"]=Ce["[object String]"]=Ce["[object WeakMap]"]=!1;var Se="object"==typeof n&&n&&!n.nodeType&&n,Ee=Se&&t&&!t.nodeType&&t,Oe=Ee&&Ee.exports===Se&&p.process,Te=function(){try{return Ee&&Ee.require&&Ee.require("util").types||Oe&&Oe.binding&&Oe.binding("util")}catch(e){}}(),Ae=Te&&Te.isTypedArray;const je=Ae?(Fe=Ae,function(e){return Fe(e)}):function(e){return ae(e)&&he(e.length)&&!!Ce[w(e)]},Ie=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]};var Fe,Ne=Object.prototype.hasOwnProperty;const Le=function(e,t,n){var r=e[t];Ne.call(e,t)&&o(r,n)&&(void 0!==n||t in e)||J(e,t,n)};var Me=/^(?:0|[1-9]\d*)$/;const Re=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&Me.test(e))&&e>-1&&e%1==0&&e<t};var Ue=Object.prototype.hasOwnProperty,De=Object.prototype.hasOwnProperty;const Pe=function(e){return fe(e)?function(e,t){var n=de(e),r=!n&&pe(e),o=!n&&!r&&be(e),i=!n&&!r&&!o&&je(e),a=n||r||o||i,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=s.length;for(var l in e)!t&&!Ue.call(e,l)||a&&("length"==l||o&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Re(l,c))||s.push(l);return s}(e,!0):function(e){if(!x(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=ie(e),n=[];for(var r in e)("constructor"!=r||!t&&De.call(e,r))&&n.push(r);return n}(e)},ze=function(e,t,n,r,o,i,a){var s,c,l=Ie(e,n),u=Ie(t,n),p=a.get(u);if(p)Z(e,n,p);else{var d=i?i(l,u,n+"",e,t,a):void 0,h=void 0===d;if(h){var f=de(u),m=!f&&be(u),g=!f&&!m&&je(u);d=u,f||m||g?de(l)?d=l:ae(s=l)&&fe(s)?d=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}(l):m?(h=!1,d=function(e,t){return e.slice()}(u)):g?(h=!1,d=function(e,t){var n,r,o=t?(r=new(n=e.buffer).constructor(n.byteLength),new X(r).set(new X(n)),r):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}(u,!0)):d=[]:function(e){if(!ae(e)||"[object Object]"!=w(e))return!1;var t=te(e);if(null===t)return!0;var n=xe.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&we.call(n)==ke}(u)||pe(u)?(d=l,pe(l)?d=function(e,t,n,r){var o=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var s=t[i],c=void 0;void 0===c&&(c=e[s]),o?J(n,s,c):Le(n,s,c)}return n}(c=l,Pe(c)):x(l)&&!k(l)||(d=function(e){return"function"!=typeof e.constructor||ie(e)?{}:ee(te(e))}(u))):h=!1}h&&(a.set(u,d),o(d,u,r,i,a),a.delete(u)),Z(e,n,d)}},qe=function e(t,n,r,o,i){t!==n&&function(e,t,n){for(var r=-1,o=Object(e),i=n(e),a=i.length;a--;){var s=i[++r];if(!1===t(o[s],s,o))break}}(n,(function(a,s){if(i||(i=new G),x(a))ze(t,n,s,r,e,o,i);else{var c=o?o(Ie(t,s),a,s+"",t,n,i):void 0;void 0===c&&(c=a),Z(t,s,c)}}),Pe)},$e=function(e){return e},He=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)};var Be=Math.max;const Ge=W?function(e,t){var n;return W(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0})}:$e;var We=Date.now;const Je=function(e){var t=0,n=0;return function(){var r=We(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Ge),Ze=(Ve=function(e,t,n){qe(e,t,n)},Ye=function(e,t){var n=-1,r=t.length,i=r>1?t[r-1]:void 0,a=r>2?t[2]:void 0;for(i=Ve.length>3&&"function"==typeof i?(r--,i):void 0,a&&function(e,t,n){if(!x(n))return!1;var r=typeof t;return!!("number"==r?fe(n)&&Re(t,n.length):"string"==r&&t in n)&&o(n[t],e)}(t[0],t[1],a)&&(i=r<3?void 0:i,r=1),e=Object(e);++n<r;){var s=t[n];s&&Ve(e,s,n)}return e},Je(function(e,t,n){return t=Be(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=Be(r.length-t,0),a=Array(i);++o<i;)a[o]=r[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=r[o];return s[t]=n(a),He(e,this,s)}}(Ye,Ke,$e),Ye+""));var Ye,Ke,Ve,Xe=function(){return Xe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Xe.apply(this,arguments)};function Qe(e){return e.toLowerCase()}Object.create,Object.create;var et=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],tt=/[^A-Z0-9]+/gi;function nt(e,t,n){return t instanceof RegExp?e.replace(t,n):t.reduce((function(e,t){return e.replace(t,n)}),e)}const rt="win32"===navigator.platform.toLowerCase()?r.win32:r.posix,ot=function(e,t){return void 0===t&&(t={}),n=e,void 0===(r=Xe({delimiter:"_"},t))&&(r={}),function(e,t){void 0===t&&(t={});for(var n=t.splitRegexp,r=void 0===n?et:n,o=t.stripRegexp,i=void 0===o?tt:o,a=t.transform,s=void 0===a?Qe:a,c=t.delimiter,l=void 0===c?" ":c,u=nt(nt(e,r,"$1\0$2"),i,"\0"),p=0,d=u.length;"\0"===u.charAt(p);)p++;for(;"\0"===u.charAt(d-1);)d--;return u.slice(p,d).split("\0").map(s).join(l)}(n,Xe({delimiter:"."},r));var n,r},it=Ze;function at(e,t){let n,r,o=!1;const i=t=>n=>{e&&clearTimeout(e),t(n),o=!0},a=new Promise(((o,a)=>{n=i(o),r=i(a),e&&(e=setTimeout((()=>r(new Error(`[deferred timeout] ${t}`))),e))}));return{created:Date.now(),setTag:e=>t=e,resolve:n,reject:r,promise:a,get settled(){return o}}}const st=new Map;window.__injectedUIEffects=st;var ct=i(227),lt=i.n(ct);const ut="application/x-postmate-v1+json";let pt=0;const dt={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},ht=(e,t)=>!("string"==typeof t&&e.origin!==t||!e.data||"object"==typeof e.data&&!("postmate"in e.data)||e.data.type!==ut||!dt[e.data.postmate]);class ft{parent;frame;child;events={};childOrigin;listener;constructor(e){this.parent=e.parent,this.frame=e.frame,this.child=e.child,this.childOrigin=e.childOrigin,this.listener=e=>{if(!ht(e,this.childOrigin))return!1;const{data:t,name:n}=((e||{}).data||{}).value||{};"emit"===e.data.postmate&&n in this.events&&this.events[n].forEach((e=>{e.call(this,t)}))},this.parent.addEventListener("message",this.listener,!1)}get(e){return new Promise((t=>{const n=++pt,r=e=>{e.data.uid===n&&"reply"===e.data.postmate&&(this.parent.removeEventListener("message",r,!1),t(e.data.value))};this.parent.addEventListener("message",r,!1),this.child.postMessage({postmate:"request",type:ut,property:e,uid:n},this.childOrigin)}))}call(e,t){this.child.postMessage({postmate:"call",type:ut,property:e,data:t},this.childOrigin)}on(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class mt{model;parent;parentOrigin;child;constructor(e){this.model=e.model,this.parent=e.parent,this.parentOrigin=e.parentOrigin,this.child=e.child,this.child.addEventListener("message",(e=>{if(!ht(e,this.parentOrigin))return;const{property:t,uid:n,data:r}=e.data;"call"!==e.data.postmate?((e,t)=>{const n="function"==typeof e[t]?e[t]():e[t];return Promise.resolve(n)})(this.model,t).then((r=>{e.source.postMessage({property:t,postmate:"reply",type:ut,uid:n,value:r},e.origin)})):t in this.model&&"function"==typeof this.model[t]&&this.model[t](r)}))}emit(e,t){this.parent.postMessage({postmate:"emit",type:ut,value:{name:e,data:t}},this.parentOrigin)}}class gt{static debug=!1;container;parent;frame;child;childOrigin;url;model;static Model;constructor(e){this.container=e.container,this.url=e.url,this.parent=window,this.frame=document.createElement("iframe"),e.id&&(this.frame.id=e.id),e.name&&(this.frame.name=e.name),this.frame.classList.add.apply(this.frame.classList,e.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=e.model||{}}sendHandshake(e){const t=(e=>{const t=document.createElement("a");t.href=e;const n=t.protocol.length>4?t.protocol:window.location.protocol,r=t.host.length?"80"===t.port||"443"===t.port?t.hostname:t.host:window.location.host;return t.origin||`${n}//${r}`})(e=e||this.url);let n,r=0;return new Promise(((o,i)=>{const a=e=>!!ht(e,t)&&("handshake-reply"===e.data.postmate?(clearInterval(n),this.parent.removeEventListener("message",a,!1),this.childOrigin=e.origin,o(new ft(this))):i("Failed handshake"));this.parent.addEventListener("message",a,!1);const s=()=>{r++,this.child.postMessage({postmate:"handshake",type:ut,model:this.model},t),5===r&&clearInterval(n)};this.frame.addEventListener("load",(()=>{s(),n=setInterval(s,500)})),this.frame.src=e}))}destroy(){this.frame.parentNode.removeChild(this.frame)}}class yt{child;model;parent;parentOrigin;constructor(e){this.child=window,this.model=e,this.parent=this.child.parent}sendHandshakeReply(){return new Promise(((e,t)=>{const n=r=>{if(r.data.postmate){if("handshake"===r.data.postmate){this.child.removeEventListener("message",n,!1),r.source.postMessage({postmate:"handshake-reply",type:ut},r.origin),this.parentOrigin=r.origin;const t=r.data.model;return t&&Object.keys(t).forEach((e=>{this.model[e]=t[e]})),e(new mt(this))}return t("Handshake Reply Failed")}};this.child.addEventListener("message",n,!1)}))}}var bt=i(729),vt=i.n(bt);const{importHTML:_t,createSandboxContainer:wt}=window.QSandbox||{};function xt(e,t){return e.startsWith("http")?fetch(e,t):(e=e.replace("file://",""),new Promise((async(t,n)=>{try{const n=await window.apis.doAction(["readFile",e]);t({text:()=>n})}catch(e){console.error(e),n(e)}})))}class kt extends(vt()){_pluginLocal;_frame;_root;_loaded=!1;_unmountFns=[];constructor(e){super(),this._pluginLocal=e,e._dispose((()=>{this._unmount()}))}async load(){const{name:e,entry:t}=this._pluginLocal.options;if(this.loaded||!t)return;const{template:n,execScripts:r}=await _t(t,{fetch:xt});this._mount(n,document.body);const o=wt(e,{elementGetter:()=>this._root?.firstChild}).instance.proxy;o.__shadow_mode__=!0,o.LSPluginLocal=this._pluginLocal,o.LSPluginShadow=this,o.LSPluginUser=o.logseq=new Gt(this._pluginLocal.toJSON(),this._pluginLocal.caller);const i=await r(o,!0);this._unmountFns.push(i.unmount),this._loaded=!0}_mount(e,t){const n=this._frame=document.createElement("div");n.classList.add("lsp-shadow-sandbox"),n.id=this._pluginLocal.id,this._root=n.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${e}</div>`,t.appendChild(n),this.emit("mounted")}_unmount(){for(const e of this._unmountFns)e&&e.call(null)}destroy(){this.frame?.parentNode?.removeChild(this.frame)}get loaded(){return this._loaded}get document(){return this._root?.firstChild}get frame(){return this._frame}}const Ct=lt()("LSPlugin:caller"),St="#await#response#",Et="#lspmsg#error#",Ot=e=>`#lspmsg#${e}`;class Tt extends(vt()){_pluginLocal;_connected=!1;_parent;_child;_shadow;_status;_userModel={};_call;_callUserModel;_debugTag="";constructor(e){super(),this._pluginLocal=e,e&&(this._debugTag=e.debugTag)}async connectToChild(){if(this._connected)return;const{shadow:e}=this._pluginLocal;e?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(e={}){if(this._connected)return;const t=this,n=null!=this._pluginLocal;let r=0,o=0;const i=new Map,a=at(6e4),s=this._extendUserModel({"#lspmsg#ready#":async e=>{s[Ot(e?.pid)]=({type:e,payload:n})=>{Ct(`[host (_call) -> *user] ${this._debugTag}`,e,n),t.emit(e,n)},await a.resolve()},"#lspmsg#beforeunload#":async e=>{const n=at(1e4);t.emit("beforeunload",Object.assign({actor:n},e)),await n.promise},"#lspmsg#settings#":async({type:e,payload:n})=>{t.emit("settings:changed",n)},"#lspmsg#":async({ns:e,type:n,payload:r})=>{Ct(`[host (async) -> *user] ${this._debugTag} ns=${e} type=${n}`,r),e&&e.startsWith("hook")?t.emit(`${e}:${n}`,r):t.emit(n,r)},"#lspmsg#reply#":({_sync:e,result:t})=>{if(Ct(`[sync host -> *user] #${e}`,t),i.has(e)){const n=i.get(e);n&&(t?.hasOwnProperty(Et)?n.reject(t[Et]):n.resolve(t),i.delete(e))}},...e});if(n)return await a.promise,JSON.parse(JSON.stringify(this._pluginLocal?.toJSON()));const c=new yt(s).sendHandshakeReply();return this._status="pending",await c.then((e=>{this._child=e,this._connected=!0,this._call=async(t,n={},r)=>{if(r){const e=++o;i.set(e,r),n._sync=e,r.setTag(`async call #${e}`),Ct(`async call #${e}`)}return e.emit(Ot(s.baseInfo.id),{type:t,payload:n}),r?.promise},this._callUserModel=async(e,t)=>{try{s[e](t)}catch(t){Ct(`[model method] #${e} not existed`)}},r=setInterval((()=>{if(i.size>100)for(const[e,t]of i)t.settled&&i.delete(e)}),18e5)})).finally((()=>{this._status=void 0})),await a.promise,s.baseInfo}async call(e,t={}){return this._call?.call(this,e,t)}async callAsync(e,t={}){const n=at(1e4);return this._call?.call(this,e,t,n)}async callUserModel(e,t={}){return this._callUserModel?.call(this,e,t)}async _setupIframeSandbox(){const e=this._pluginLocal,t=e.id,n=`${t}_lsp_main`,r=new URL(e.options.entry);r.searchParams.set("__v__",e.options.version);const o=document.querySelector(`#${n}`);o&&o.parentElement.removeChild(o);const i=document.createElement("div");i.classList.add("lsp-iframe-sandbox-container"),i.id=n,i.dataset.pid=t;try{const e=(await this._pluginLocal._loadLayoutsData())?.$$0;if(e){i.dataset.inited_layout="true";const{width:t,height:n,left:r,top:o}=e;Object.assign(i.style,{width:t+"px",height:n+"px",left:r+"px",top:o+"px"})}}catch(e){console.error("[Restore Layout Error]",e)}document.body.appendChild(i);const a=new gt({id:t+"_iframe",container:i,url:r.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(e.toJSON()))}});let s,c=a.sendHandshake();return this._status="pending",new Promise(((t,n)=>{s=setTimeout((()=>{n(new Error("handshake Timeout")),a.destroy()}),4e3),c.then((n=>{this._parent=n,this._connected=!0,this.emit("connected"),n.on(Ot(e.id),(({type:e,payload:t})=>{Ct("[user -> *host] ",e,t),this._pluginLocal?.emit(e,t||{})})),this._call=async(...t)=>{await n.call(Ot(e.id),{type:t[0],payload:Object.assign(t[1]||{},{$$pid:e.id})})},this._callUserModel=async(e,t)=>{if(e.startsWith(St))return await n.get(e.replace(St,""));n.call(e,t)},t(null)})).catch((e=>{n(e)})).finally((()=>{clearTimeout(s)}))})).catch((e=>{throw Ct("[iframe sandbox] error",e),e})).finally((()=>{this._status=void 0}))}async _setupShadowSandbox(){const e=this._pluginLocal,t=this._shadow=new kt(e);try{this._status="pending",await t.load(),this._connected=!0,this.emit("connected"),this._call=async(t,n={},r)=>(r&&(n.actor=r),this._pluginLocal?.emit(t,Object.assign(n,{$$pid:e.id})),r?.promise),this._callUserModel=async(...e)=>{let t=e[0];t?.startsWith(St)&&(t=t.replace(St,""));const n=e[1]||{},r=this._userModel[t];"function"==typeof r&&await r.call(null,n)}}catch(e){throw Ct("[shadow sandbox] error",e),e}finally{this._status=void 0}}_extendUserModel(e){return Object.assign(this._userModel,e)}_getSandboxIframeContainer(){return this._parent?.frame.parentNode}_getSandboxShadowContainer(){return this._shadow?.frame.parentNode}_getSandboxIframeRoot(){return this._parent?.frame}_getSandboxShadowRoot(){return this._shadow?.frame}set debugTag(e){this._debugTag=e}async destroy(){let e=null;this._parent&&(e=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(e=this._getSandboxShadowContainer(),this._shadow.destroy()),e?.parentNode.removeChild(e)}}class At{ctx;opts;constructor(e,t){this.ctx=e,this.opts=t}get ctxId(){return this.ctx.baseInfo.id}setItem(e,t){return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,e,t,this.opts?.assets]})}getItem(e){return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,e,this.opts?.assets]})}removeItem(e){return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,e,this.opts?.assets]})}allKeys(){return this.ctx.caller.callAsync("api:call",{method:"list-plugin-storage-files",args:[this.ctxId,this.opts?.assets]})}clear(){return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId,this.opts?.assets]})}hasItem(e){return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,e,this.opts?.assets]})}}class jt{ctx;constructor(e){this.ctx=e}get React(){return this.ensureHostScope().React}get ReactDOM(){return this.ensureHostScope().ReactDOM}get pluginLocal(){return this.ensureHostScope().LSPluginCore.ensurePlugin(this.ctx.baseInfo.id)}invokeExperMethod(e,...t){const n=this.ensureHostScope();return e=ot(e)?.toLowerCase(),n.logseq.api["exper_"+e]?.apply(n,t)}async loadScripts(...e){(e=e.map((e=>e?.startsWith("http")?e:this.ctx.resolveResourceFullUrl(e)))).unshift(this.ctx.baseInfo.id),await this.invokeExperMethod("loadScripts",...e)}registerFencedCodeRenderer(e,t){return this.ensureHostScope().logseq.api.exper_register_fenced_code_renderer(this.ctx.baseInfo.id,e,t)}registerExtensionsEnhancer(e,t){const n=this.ensureHostScope();return"katex"===e&&n.katex&&t(n.katex).catch(console.error),n.logseq.api.exper_register_extensions_enhancer(this.ctx.baseInfo.id,e,t)}ensureHostScope(){if(window===top)throw new Error("Can not access host scope!");return top}}const It=e=>`task_callback_${e}`;class Ft{_client;_requestId;_requestOptions;_promise;_aborted=!1;constructor(e,t,n={}){this._client=e,this._requestId=t,this._requestOptions=n,this._promise=new Promise(((e,t)=>{if(!this._requestId)return t(null);this._client.once(It(this._requestId),(n=>{n&&n instanceof Error?t(n):e(n)}))}));const{success:r,fail:o,final:i}=this._requestOptions;this._promise.then((e=>{r?.(e)})).catch((e=>{o?.(e)})).finally((()=>{i?.()}))}abort(){this._requestOptions.abortable&&!this._aborted&&(this._client.ctx._execCallableAPI("http_request_abort",this._requestId),this._aborted=!0)}get promise(){return this._promise}get client(){return this._client}get requestId(){return this._requestId}}class Nt extends bt.EventEmitter{_ctx;constructor(e){super(),this._ctx=e,this.ctx.caller.on("#lsp#request#callback",(e=>{const t=e?.requestId;t&&this.emit(It(t),e?.payload)}))}static createRequestTask(e,t,n){return new Ft(e,t,n)}async _request(e){const t=this.ctx.baseInfo.id,{success:n,fail:r,final:o,...i}=e,a=this.ctx.Experiments.invokeExperMethod("request",t,i),s=Nt.createRequestTask(this.ctx.Request,a,e);return i.abortable?s:s.promise}get ctx(){return this._ctx}}const Lt=Symbol.for("proxy-continue"),Mt=lt()("LSPlugin:user");function Rt(e,t,n){if("function"!=typeof n)return!1;const{key:r,label:o,desc:i,palette:a,keybinding:s,extras:c}=t,l=`SimpleCommandHook${r}${++Pt}`;this.Editor["on"+l](n),this.caller?.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:r,label:o,type:e,desc:i,keybinding:s,extras:c},["editor/hook",l]],a]})}let Ut=null;const Dt={async getInfo(e){return Ut||(Ut=await this._execCallableAPIAsync("get-app-info")),"string"==typeof e?Ut[e]:Ut},registerCommand:Rt,registerCommandPalette(e,t){const{key:n,label:r,keybinding:o}=e;return Rt.call(this,"$palette$",{key:n,label:r,palette:!0,keybinding:o},t)},registerCommandShortcut(e,t){const{binding:n}=e,r="$shortcut$",o=r+ot(n);return Rt.call(this,r,{key:o,palette:!1,keybinding:e},t)},registerUIItem(e,t){const n=this.baseInfo.id;this.caller?.call("api:call",{method:"register-plugin-ui-item",args:[n,e,t]})},registerPageMenuItem(e,t){if("function"!=typeof t)return!1;const n=e+"_"+this.baseInfo.id,r=e;Rt.call(this,"page-menu-item",{key:n,label:r},t)},setFullScreen(e){const t=(...e)=>this._callWin("setFullScreen",...e);"toggle"===e?this._callWin("isFullScreen").then((e=>{e?t():t(!0)})):e?t(!0):t()}};let Pt=0;const zt={newBlockUUID(){return this._execCallableAPIAsync("new_block_uuid")},registerSlashCommand(e,t){Mt("Register slash command #",this.baseInfo.id,e,t),"function"==typeof t&&(t=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",t]]),t=t.map((e=>{const[t,...n]=e;if("editor/hook"===t){let r=n[0],o=()=>{this.caller?.callUserModel(r)};"function"==typeof r&&(o=r);const i=`SlashCommandHook${t}${++Pt}`;e[1]=i,this.Editor["on"+i](o)}return e})),this.caller?.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[e,t]]})},registerBlockContextMenuItem(e,t){if("function"!=typeof t)return!1;const n=e+"_"+this.baseInfo.id;Rt.call(this,"block-context-menu-item",{key:n,label:e},t)},registerHighlightContextMenuItem(e,t,n){if("function"!=typeof t)return!1;const r=e+"_"+this.baseInfo.id;Rt.call(this,"highlight-context-menu-item",{key:r,label:e,extras:n},t)},scrollToBlockInPage(e,t,n){const r="block-content-"+t;n?.replaceState?this.App.replaceState("page",{name:e},{anchor:r}):this.App.pushState("page",{name:e},{anchor:r})}},qt={onBlockChanged(e,t){const n=this.baseInfo.id,r=`hook:db:${ot(`block:${e}`)}`,o=({block:n,txData:r,txMeta:o})=>{n.uuid===e&&t(n,r,o)};return this.caller.on(r,o),this.App._installPluginHook(n,r),()=>{this.caller.off(r,o),this.App._uninstallPluginHook(n,r)}}},$t={},Ht={},Bt={makeSandboxStorage(){return new At(this,{assets:!0})}};class Gt extends(vt()){_baseInfo;_caller;_version="0.0.10";_debugTag="";_settingsSchema;_connected=!1;_ui=new Map;_mFileStorage;_mRequest;_mExperiments;_beforeunloadCallback;constructor(e,t){super(),this._baseInfo=e,this._caller=t,t.on("sys:ui:visible",(e=>{e?.toggle&&this.toggleMainUI()})),t.on("settings:changed",(e=>{const t=Object.assign({},this.settings),n=Object.assign(this._baseInfo.settings,e);this.emit("settings:changed",{...n},t)})),t.on("beforeunload",(async e=>{const{actor:n,...r}=e,o=this._beforeunloadCallback;try{o&&await o(r),n?.resolve(null)}catch(e){console.debug(`${t.debugTag} [beforeunload] `,e),n?.reject(e)}}))}async ready(e,t){if(!this._connected)try{"function"==typeof e&&(t=e,e={});let n=await this._caller.connectToParent(e);this._connected=!0,n=it(this._baseInfo,n),this._settingsSchema&&(n.settings=function(e,t){const n=(t||[]).reduce(((e,t)=>("default"in t&&(e[t.key]=t.default),e)),{});return Object.assign(n,e)}(n.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema)),n?.id&&(this._debugTag=this._caller.debugTag=`#${n.id} [${n.name}]`);try{await this._execCallableAPIAsync("setSDKMetadata",{version:this._version})}catch(e){console.warn(e)}t&&t.call(this,n)}catch(e){console.error(`${this._debugTag} [Ready Error]`,e)}}ensureConnected(){if(!this._connected)throw new Error("not connected")}beforeunload(e){"function"==typeof e&&(this._beforeunloadCallback=e)}provideModel(e){return this.caller._extendUserModel(e),this}provideTheme(e){return this.caller.call("provider:theme",e),this}provideStyle(e){return this.caller.call("provider:style",e),this}provideUI(e){return this.caller.call("provider:ui",e),this}useSettingsSchema(e){return this.connected&&this.caller.call("settings:schema",{schema:e,isSync:!0}),this._settingsSchema=e,this}updateSettings(e){this.caller.call("settings:update",e)}onSettingsChanged(e){const t="settings:changed";return this.on(t,e),()=>this.off(t,e)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(e){this.caller.call("main-ui:attrs",e)}setMainUIInlineStyle(e){this.caller.call("main-ui:style",e)}hideMainUI(e){const t={key:0,visible:!1,cursor:e?.restoreEditingCursor};this.caller.call("main-ui:visible",t),this.emit("ui:visible:changed",t),this._ui.set(t.key,t)}showMainUI(e){const t={key:0,visible:!0,autoFocus:e?.autoFocus};this.caller.call("main-ui:visible",t),this.emit("ui:visible:changed",t),this._ui.set(t.key,t)}toggleMainUI(){const e=this._ui.get(0);e&&e.visible?this.hideMainUI():this.showMainUI()}get version(){return this._version}get isMainUIVisible(){const e=this._ui.get(0);return Boolean(e&&e.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get settings(){return this.baseInfo?.settings}get caller(){return this._caller}resolveResourceFullUrl(e){if(this.ensureConnected(),e)return e=e.replace(/^[.\\/]+/,""),function(e,...t){try{const n=new URL(e);if(!n.origin)throw new Error(null);const r=rt.join(e.substr(n.origin.length),...t);return n.origin+r}catch(n){return rt.join(e,...t)}}(this._baseInfo.lsr,e)}_makeUserProxy(e,t){const n=this,r=this.caller;return new Proxy(e,{get(e,o,i){const a=e[o];return function(...e){if(a){const r=a.apply(n,e.concat(t));if(r!==Lt)return r}if(t){const i=o.toString().match(/^(once|off|on)/i);if(null!=i){const o=i[0].toLowerCase(),a=i.input.slice(o.length),s="off"===o,c=n.baseInfo.id,l=`hook:${t}:${ot(a)}`,u=e[0];r[o](l,u);const p=()=>{r.off(l,u),r.listenerCount(l)||n.App._uninstallPluginHook(c,l)};return s?void p():(n.App._installPluginHook(c,l),p)}}let i=o;return["git","ui","assets"].includes(t)&&(i=t+"_"+i),r.callAsync("api:call",{tag:t,method:i,args:e})}}})}_execCallableAPIAsync(e,...t){return this._caller.callAsync("api:call",{method:e,args:t})}_execCallableAPI(e,...t){this._caller.call("api:call",{method:e,args:t})}_callWin(...e){return this._execCallableAPIAsync("_callMainWin",...e)}get App(){return this._makeUserProxy(Dt,"app")}get Editor(){return this._makeUserProxy(zt,"editor")}get DB(){return this._makeUserProxy(qt,"db")}get Git(){return this._makeUserProxy($t,"git")}get UI(){return this._makeUserProxy(Ht,"ui")}get Assets(){return this._makeUserProxy(Bt,"assets")}get FileStorage(){let e=this._mFileStorage;return e||(e=this._mFileStorage=new At(this)),e}get Request(){let e=this._mRequest;return e||(e=this._mRequest=new Nt(this)),e}get Experiments(){let e=this._mExperiments;return e||(e=this._mExperiments=new jt(this)),e}}function Wt(e,t){return new Gt(e,t)}if(null==window.__LSP__HOST__){const e=new Tt(null);window.logseq=Wt({},e)}})(),a})(),"object"==typeof n?t.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof n?n.LSPluginEntry=o():r.LSPluginEntry=o()})),r("hYbfg");let o=null,i=null,a=null,s=null,c=1;function l(){return{token:logseq.settings.token,apiUrl:logseq.settings.apiUrl,maxTokens:Number.parseInt(logseq.settings.maxTokens),number:Number.parseInt(logseq.settings.number),isindex:logseq.settings.isindex,hotkeyGenerate:logseq.settings["hotkey-generate"],hotkeySearch:logseq.settings["hotkey-search"],article_type:logseq.settings.article_type}}async function u(){c=1==c?0:1}async function p(e){const{token:t,apiUrl:n,maxTokens:r,number:c,isindex:u,hotkeyGenerate:p,hotkeySearch:m,article_type:g}=l();if(a=await logseq.Editor.getBlock(e.uuid),i=e.uuid,o=await logseq.Editor.getPage(a.page.id),!o)return;let y=[];const b=await logseq.Editor.getPageBlocksTree(o.name);for(const e of b){const t=e.content;if(t.length>0&&y.push(t),a.uuid==e.uuid)break}const v=y.join("\n");if(0===v.length)return logseq.App.showMsg("Empty Content","warning"),void console.warn("Blank page");if(!a)return void console.error("No current block");let _={context:v,token:t,model_size:"distilgpt2/small",article_type:g,top_p:.9,temperature:1,max_time:1.2,max_length:r,is_index:u,number:c};try{let e=await fetch(n+"generate",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify(_)}),t=await e.json(),r=t.keywords;if(u){let e="<div style='width:100%'><h3  class='h3'>Keyword: "+r+"</h3></div>";e+=h(r,t.page,1),""!=t&&(e+='<div style="width:100%">'+t.ref.map((function(e){return'<h3 class="h3">'+e.title+"</h3>"+e.content})).join("<br>")+"</div>");const{left:n,top:o,rect:a}=await logseq.Editor.getEditingCursorPosition();s=a,await logseq.provideUI(d(s,e)),f(t.sentences,n+5+a.left,o+a.top),await logseq.Editor.editBlock(i)}}catch(e){console.error(e)}}logseq.useSettingsSchema([{key:"token",type:"string",default:"",title:"welm token",description:"Your welm token. You can get one at https://welm.app"},{key:"hotkey-generate",type:"string",default:"ctrl+'",title:"set hotkey",description:"set a hotkey to generate text, must be a valid keybinding, no space, like ctrl+'"},{key:"hotkey-search",type:"string",default:"ctrl+;",title:"set hotkey-search",description:"set a hotkey for full-text search, must be a valid keybinding, no space, like ctrl+;"},{key:"apiUrl",type:"string",default:"https://fwzd.myfawu.com/",title:"service api url",description:"service api url. you can build you personal service"},{key:"maxTokens",type:"number",default:10,title:"Max Tokens",description:"The maximum amount of tokens to generate. The more tokens, the longer the generation will take."},{key:"number",type:"number",default:3,title:"generate number",description:"generate number"},{key:"isindex",type:"boolean",default:3,title:"full-text search",description:"full text search enabled?"},{key:"article_type",type:"string",default:"article",title:"article type",description:"article type"}]);const d=(e,t)=>({title:"Sengener Full-text search",template:`\n     <div style="padding: 10px; " id="optionBar" class="optionBar">     \n        ${t}\n      </div>\n    `,style:{height:"800px",top:"80px",overflow:"auto",padding:"2px 4px",borderRadius:"4px",display:"flex",width:"400px",left:e.right-10+"px",border:"1px solid var(--ls-border-color)",backgroundColor:"var(--ls-primary-background-color)",color:"var(--ls-primary-text-color)",boxShadow:"1px 2px 5px var(--ls-secondary-background-color)"}});function h(e,t,n){let r='<div width="100%">',o=t>5&&n-2>1?n-2:1;o=t<=5||o+4<t?o:t-4;let i=o+4>t?n+2<=t&&t>5?n+2:t:o+4;1<o&&(r+='<a class="pagebar" data-data="'+e+'" data-on-click="searchTerm" data-page="'+(o-3)+'"><<</a>');for(let t=o;t<=i;t++)r+=n!=t?'<a class="pagebar" data-data="'+e+'"  data-on-click="searchTerm" data-page="'+t+'">'+t+"</a>":'<a class="pagebar match" data-data="'+e+'" data-on-click="searchTerm"  data-page="'+t+'">'+t+"</a>";return t>i&&(r+='<a class="pagebar" data-data="'+e+'" data-on-click="searchTerm" data-page="'+(i+3)+'">>></a>'),r+"</div>"}function f(e,t,n){console.log(t,n);let r={left:(t<1200?t:t-300)+"px",top:(n<820?n:n-16-16*e.length)+"px",width:17*e.map((e=>e.value.length)).sort(((e,t)=>t-e))[0]+"px",fontSize:"16px",padding:"4px",margin:"10px",borderRadius:"4px",userSelect:"none",cursor:"default",listStyleType:"none",textAlign:"left",border:"1px solid var(--ls-border-color)",color:"#202020",backgroundColor:"#808080",position:"absolute",boxShadow:"1px 2px 5px #606060"};const o=document.getElementById("inner1"),i=document.getElementById("content");Object.assign(i.style,r),i.innerHTML=e.map(((e,t)=>`<li data-on-click="insertText" data-value="${e.value}" id="option_${t}" >${e.value}</li>`)).join(""),o.style.display="block";let a=0;document.getElementById("option_"+a).style.backgroundColor="#606060",document.addEventListener("click",(async function(e){logseq.hideMainUI()})),document.addEventListener("keyup",(async function(t){if(["ArrowUp","ArrowDown","Escape","Enter"].includes(t.key))if("Escape"===t.key)logseq.hideMainUI();else if("Enter"===t.key){let t=await logseq.Editor.getCurrentBlock();await logseq.Editor.updateBlock(t.uuid,t.content+e[a].value),logseq.hideMainUI(),setTimeout((async()=>{logseq.Editor.editBlock(t.uuid)}),2e3)}else"ArrowDown"!==t.key&&"ArrowUp"!==t.key||(document.getElementById("option_"+a).style.backgroundColor="","ArrowDown"===t.key?(a++,a>=e.length&&(a=0)):"ArrowUp"===t.key&&(a--,a<0&&(a=e.length-1)),document.getElementById("option_"+a).style.backgroundColor="#606060")})),logseq.showMainUI()}async function m(e,t){const{token:n,apiUrl:r,maxTokens:o,number:i,isindex:a,hotkeyGenerate:c,hotkeySearch:u,article_type:p}=l();let f={context:e,page:t,article_type:p,token:n};try{let n=await fetch(r+"refer",{method:"post",headers:{"content-type":"application/json"},body:JSON.stringify(f)}),o=await n.json(),i="<div style='width:100%'><h3  class='h3'>Keyword: "+e+"</h3></div>";i+=h(e,o.page,t),""!=o&&(i+='<div style="width:100%">'+o.ref.map((function(e){return'<h3 class="h3">'+e.title+"</h3>"+e.content})).join("<br>")+"</div>",console.log(s),await logseq.provideUI(d(s,i)))}catch(e){console.log(e)}}logseq.provideModel({async searchTerm(e){let t=e.dataset.data,n=parseInt(e.dataset.page);await m(t,n)}}),logseq.ready((async function(){logseq.App.showMsg("load generate plugin success","success"),logseq.App.registerCommand("generate",{key:"generate",label:"generate",keybinding:{binding:l().hotkeyGenerate}},p),logseq.App.registerCommand("SelectionToFulltextSearch",{key:"fulltextSearch",label:"selection-to-fulltext-search",keybinding:{binding:l().hotkeySearch}},u),logseq.Editor.onInputSelectionEnd((async e=>{if(c){const{left:t,top:n,rect:r}=await logseq.Editor.getEditingCursorPosition();s=r;const{token:o,apiUrl:i,maxTokens:a,number:c,isindex:u,hotkeyGenerate:p,hotkeySearch:d,article_type:h}=l();await m(e.text,1)}})),logseq.provideStyle("\n            // .optionBar{\n            //     border: 1px solid var(--ls-border-color);\n            //     background-color: 'var(--ls-primary-background-color);\n            //     color: var(--ls-primary-text-color);\n            //     boxShadow: 1px 2px 5px var(--ls-secondary-background-color);\n            //     height:800px;\n            //     top:40px;\n            //     left:800px;\n            //     overflow:auto;\n            //     padding: 2px 4px;\n            //     border-radius: 4px;\n            //     width: 400px\n            //   }     \n            .match { color: #ff0000;} \n            .pagebar { width: 40px; color: #808080; cursor: pointer; margin: 5px 5px; border: 1px solid #808080; border-radius: 1px; padding: 5px 5px; }\n            .h3 {font-size: 20px; font-weight: bold; margin: 0 0 4px 0; padding: 1px; }\n \n            ")})).catch(console.error);